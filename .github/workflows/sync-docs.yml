name: Sync Documentation to Agent Repos

on:
  push:
    branches: [main]
    paths:
      - 'memory-files/**'
      - 'DOCS_INDEX.md'
      - 'ARCHITECTURE_UPDATE_SUMMARY.md'

jobs:
  sync-to-jpsrealtor:
    name: Sync to jpsrealtor
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ChatRealty
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Sync architecture docs to jpsrealtor
        uses: cpina/github-action-push-to-another-repository@main
        env:
          SSH_DEPLOY_KEY: ${{ secrets.SSH_DEPLOY_KEY }}
        with:
          source-directory: 'memory-files'
          destination-github-username: 'VirtualJoe760'
          destination-repository-name: 'jpsrealtor'
          target-directory: 'docs/platform'
          target-branch: 'v2'
          commit-message: 'ðŸ“š docs: sync architecture from ChatRealty platform'
          user-email: claude-sync@chatrealty.io
          user-name: ChatRealty Docs Bot

  sync-to-chatrealty-cms:
    name: Sync to chatrealty-cms
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ChatRealty
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Sync architecture docs to chatrealty-cms
        uses: cpina/github-action-push-to-another-repository@main
        env:
          SSH_DEPLOY_KEY: ${{ secrets.SSH_DEPLOY_KEY }}
        with:
          source-directory: 'memory-files'
          destination-github-username: 'VirtualJoe760'
          destination-repository-name: 'chatrealty-cms'
          target-directory: 'docs/platform'
          target-branch: 'main'
          commit-message: 'ðŸ“š docs: sync architecture from ChatRealty platform'
          user-email: claude-sync@chatrealty.io
          user-name: ChatRealty Docs Bot

  notify-completion:
    name: Notify Sync Completion
    runs-on: ubuntu-latest
    needs: [sync-to-jpsrealtor, sync-to-chatrealty-cms]
    steps:
      - name: Log completion
        run: |
          echo "âœ… Documentation successfully synced to all agent repos"
          echo "  â†’ jpsrealtor/docs/platform/"
          echo "  â†’ chatrealty-cms/docs/platform/"
